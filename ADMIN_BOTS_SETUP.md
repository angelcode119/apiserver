# ?? ??????? ????? ???????? ????? ???? (Administrator)

## ?????

????? ???? (Administrator/Super Admin) ?? ???? ?????? ???? ????? ????? ???? ??????? 5 ???? ????? ????? ???? ?? ?? ???? `.env` ??????? (??? ???? 2FA).

---

## ?? ????? ?? ???

### ? ???:
```
Administrator ????? ????? ??:
- 5 ???? placeholder (???)
- ???????: ADMIN_BOT1_TOKEN_HERE
- Chat ID ??: -1001ADMIN1_CHATID
- ??? ????????! ?
```

### ? ????:
```
Administrator ????? ????? ??:
- 5 ???? ????? ?? .env
- ???????: ?? config ???????
- Chat ID ??: ?? config ???????
- ?? ???? ??? ??? ??????! ?
```

---

## ?? ????? ?????

### ????? 1??: ???? 5 ???? ?? ??????

??? ?? @BotFather ?? ?????? ? 5 ???? ????:

```
/newbot
Name: Admin Devices Bot
Username: your_admin_devices_bot
? Token: 1111111111:AAA... (????? ??!)

/newbot
Name: Admin SMS Bot
Username: your_admin_sms_bot
? Token: 2222222222:BBB... (????? ??!)

/newbot
Name: Admin Logs Bot
Username: your_admin_logs_bot
? Token: 3333333333:CCC... (????? ??!)

/newbot
Name: Admin Auth Bot
Username: your_admin_auth_bot
? Token: 4444444444:DDD... (????? ??!)

/newbot
Name: Admin Future Bot
Username: your_admin_future_bot
? Token: 5555555555:EEE... (????? ??!)
```

### ????? 2??: ?????? Chat ID ??

**????? A: ?? ?? ???? ??? (???????):**

1. ?? ????? ?? ???? ?? ?????? ????
2. ??? 5 ???? ?? ?? ??? ?????/???? ????? ??
3. ?? ???? ?????
4. ???? ?? ???? ??? ??:
   ```
   https://api.telegram.org/bot<TOKEN>/getUpdates
   ```
5. chat.id ?? ???? ?? (?????: `-1001234567890`)
6. **??? 5 ???? ??????? ???? chat_id ?? ????? ????!**

**????? B: 5 ?? ??????? (???????????????):**

1. 5 ?????/???? ??????? ????:
   - ????? 1: Devices
   - ????? 2: SMS
   - ????? 3: Logs
   - ????? 4: Auth
   - ????? 5: Future
2. ?? ???? ?? ?? ????? ?????? ????? ??
3. Chat ID ?? ????? ?? ????

### ????? 3??: ????? ???? `.env`

???? `.env` ?? ?? ??? ????? ???? ?? ?????? ??:

```bash
# 2FA Bot (????? ???? ??? ????????)
TELEGRAM_2FA_BOT_TOKEN=1234567890:ABC-YOUR-2FA-BOT-TOKEN
TELEGRAM_2FA_CHAT_ID=-1001234567890

# Administrator's 5 Bots
ADMIN_BOT1_TOKEN=1111111111:AAA-YOUR-BOT1-TOKEN
ADMIN_BOT1_CHAT_ID=-1001111111111

ADMIN_BOT2_TOKEN=2222222222:BBB-YOUR-BOT2-TOKEN
ADMIN_BOT2_CHAT_ID=-1002222222222

ADMIN_BOT3_TOKEN=3333333333:CCC-YOUR-BOT3-TOKEN
ADMIN_BOT3_CHAT_ID=-1003333333333

ADMIN_BOT4_TOKEN=4444444444:DDD-YOUR-BOT4-TOKEN
ADMIN_BOT4_CHAT_ID=-1004444444444

ADMIN_BOT5_TOKEN=5555555555:EEE-YOUR-BOT5-TOKEN
ADMIN_BOT5_CHAT_ID=-1005555555555
```

**????:** ??????? ??? chat_id ?? ?? ????? ????? (??? ?? ?? ?? ????)

### ????? 4??: ?????? ????

```bash
python run.py
```

**?????:**
- ????? `admin` ?? 5 ???? ????? ????? ???? ?
- ?? ???? ??? ?????????? ??????? ?

---

## ?? ????? ???????

### ?? ???? ??? ????:

???? ???? ?????? ???? ???? ?????:

```
?? Starting Control Server...
?? Connecting to MongoDB...
? MongoDB connected successfully!
? Default super admin created!
   Username: admin
   Password: 1234567899
   Device Token: abc123...
   2FA Chat ID: -1001234567890
   Telegram Bots: 5
? Server is ready!
```

### ?? ???? ?? API:

```bash
# ?????
curl -X POST http://localhost:8765/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"1234567899"}'

# ??? 2FA ?????? ?? OTP ?? ???? ??
# ??? ?? ?????? ??????? ????? ?? ????

curl -X GET http://localhost:8765/auth/me \
  -H "Authorization: Bearer <TOKEN>"
```

**????? ???? ????:**
```json
{
  "username": "admin",
  "telegram_2fa_chat_id": "-1001234567890",
  "telegram_bots": [
    {"bot_id": 1, "bot_name": "Administrator_Devices", "token": "111...", "chat_id": "-100111..."},
    {"bot_id": 2, "bot_name": "Administrator_SMS", "token": "222...", "chat_id": "-100222..."},
    {"bot_id": 3, "bot_name": "Administrator_Logs", "token": "333...", "chat_id": "-100333..."},
    {"bot_id": 4, "bot_name": "Administrator_Auth", "token": "444...", "chat_id": "-100444..."},
    {"bot_id": 5, "bot_name": "Administrator_Future", "token": "555...", "chat_id": "-100555..."}
  ]
}
```

---

## ?? ??? ????

### ??? 1: ????? (???? 4 + 2FA)

```bash
POST /auth/login
```

**??????:**
- ?? OTP ?? ???? 2FA ????
- ?????????? ???? ?? Bot 4 ????

### ??? 2: ?????? ?????? (???? 1)

?? ???????? ??????? ?? ?????? ?????? ??.

**??????:**
- ?????????? ?? Bot 1 ????:
  ```
  ?? New Device Registered
  ?? Device ID: ...
  ?? Model: ...
  ```

### ??? 3: SMS ???? (???? 2)

?? SMS ?? ?????? ?????.

**??????:**
- ?????????? ?? Bot 2 ????:
  ```
  ?? New SMS Received
  ?? Device: ...
  ?? From: ...
  ```

### ??? 4: ????? ????? (???? 3)

```bash
POST /api/devices/{device_id}/command
```

**??????:**
- ?????????? ?? Bot 3 ????:
  ```
  ?? Command Sent
  ?? Admin: admin
  ? Command: ...
  ```

---

## ? ?????? ??????

### Q: ??? ???? ??????? ?? ????? ???? ?? ?????

**A:** ????? ????? ???? ??? ?????????? ????????. ???????? placeholder ?? ??????? ????? ???? ??? ??? ???????.

### Q: ??????? ????? ??????? ?? ????? ????

**A:** ???! ?? ??? ????:

**??? 1: ?? API:**
```bash
PUT /admin/update/admin
{
  "telegram_bots": [
    {"bot_id": 1, "token": "NEW_TOKEN", "chat_id": "..."},
    ...
  ]
}
```

**??? 2: ?? ???????:**
```javascript
db.admins.updateOne(
  {username: "admin"},
  {$set: {"telegram_bots.0.token": "NEW_TOKEN"}}
)
```

### Q: Administrator ??? ?????????????? ??? ???????? ?? ????????

**A:** ???! ?? ??? ?? ????? ???? ?????????? ???????? Administrator ?? ???? ?????????? ?? ??????? (?? ???? ????? ????).

### Q: ?? ????? ??? ?????????? ???? ?? ????????

**A:** ???! ??????:
- **Super Admin (Administrator):** ??? ????????? ?? ???????
- **Admin ??????:** ??? ??????????? ?? ?? device_token ??? ?????? ???

### Q: ??? ????? ???? ?????? ???? ????? ????

**A:** ???? ???? ????? 5 ???? ??? ???:

```bash
POST /admin/create
{
  "username": "user1",
  "password": "pass123",
  "email": "user1@example.com",
  "telegram_2fa_chat_id": "-100USER1_2FA",
  "telegram_bots": [
    {"bot_id": 1, "bot_name": "user1_devices", "token": "...", "chat_id": "..."},
    {"bot_id": 2, "bot_name": "user1_sms", "token": "...", "chat_id": "..."},
    {"bot_id": 3, "bot_name": "user1_logs", "token": "...", "chat_id": "..."},
    {"bot_id": 4, "bot_name": "user1_auth", "token": "...", "chat_id": "..."},
    {"bot_id": 5, "bot_name": "user1_future", "token": "...", "chat_id": "..."}
  ]
}
```

?? ??? ???? ??????? ?????? 5 ?? placeholder ?????? ?? ????? ???? ????? ???.

---

## ? ?? ???? ?????

- [ ] 5 ???? ?? @BotFather ?????
- [ ] ???? ??? ??????? ?? ????
- [ ] Chat ID ?? ?? ?????
- [ ] ???? `.env` ?? ????? ????
- [ ] ???? ?? ?????? ????
- [ ] ??? `? Default super admin created!` ?? ????
- [ ] ?? API ??????? ?? ?? ????
- [ ] ??? ????? ???? (OTP + Bot 4)
- [ ] ??? ?????? ?????? ???? (Bot 1)
- [ ] ??? SMS ???? (Bot 2)

---

**???? ???? ?????! ????**

??? ????? ?????? ??????? ??? ?? ????:
- `BOT_SYSTEM_GUIDE.md` - ??????? ???? ?????
- `CONFIGURE_ADMIN_BOTS.md` - ??????? ???????
- `2FA_IMPLEMENTATION.md` - ????? 2FA
