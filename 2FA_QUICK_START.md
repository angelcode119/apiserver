# ?? 2FA - ??????? ????

## ????? ????

????? 2FA ????? ????? ??! ???? ???? ????? ???? ?? 6 ???? ?? ?????? ???? ???.

---

## ???? ??? ???????

### ??? (???? 2FA):
```
Username + Password ? ? ????? ???!
```

### ???? (?? 2FA):
```
Username + Password ? ?? OTP ?? ?????? ? ???? ???? ?? ? ? ????? ???!
```

---

## ????/??????? ????

### ??????? ???? (????):
```python
# ????: app/services/auth_service.py
# ?? 17:
ENABLE_2FA = False  # ????? ??? ?? False
```

### ???? ????:
```python
ENABLE_2FA = True  # ??????? ?? True
```

---

## ??? ????

### 1. ???? 2FA (???????):
```bash
curl -X POST http://localhost:8765/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"1234567899"}'

# ???????? access_token ??????????
```

### 2. ?? 2FA (????):
```bash
# ????? 1: ?????
curl -X POST http://localhost:8765/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"1234567899"}'

# Response:
# {
#   "temp_token": "eyJhbGc...",
#   "message": "OTP sent to Telegram"
# }

# ????? 2: ?? ?? ?? ?????? ???? ? verify ??
curl -X POST http://localhost:8765/auth/verify-2fa \
  -H "Content-Type: application/json" \
  -d '{
    "username":"admin",
    "otp_code":"123456",
    "temp_token":"eyJhbGc..."
  }'

# Response:
# {
#   "access_token": "eyJhbGc...",
#   "admin": {...}
# }
```

---

## ??????? ????

????: `2FA_IMPLEMENTATION.md`

---

## ????? ???????

| ???? | ??????? |
|------|---------|
| `app/services/auth_service.py` | ????? ??: `ENABLE_2FA`, `create_temp_token()`, `verify_temp_token()` |
| `app/services/otp_service.py` | **????**: ????? ?????? OTP |
| `app/models/otp_schemas.py` | **????**: Schema ??? OTP |
| `app/main.py` | ????? ??: `/auth/login`, ????? ??: `/auth/verify-2fa` |
| `app/database.py` | ????? ??: index ??? `otp_codes` |

---

## ???? ???

? ?? OTP 6 ???? ???  
? ?? ??? 5 ????? ??????  
? ?????? 3 ??? ???? ?? ?????? ??  
? ?? ?? ??? ????? ???? ???????  
? ?? `ENABLE_2FA = False` ???? ???????? ???  

---

?????? ???? ????? 2FA ????! ??
